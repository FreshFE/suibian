{{extends file="../Bases/layout.html"}}

{{block 'mainarea'}}
	
	<div id="J_map" style="height: 600px;"></div>

{{/block}}

{{block 'bodyjs'}}

<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=true"></script>
<!--
<script type="text/javascript" src="http://api.map.baidu.com/api?v=1.4"></script>
-->
<script type="text/javascript">
	
	// 构造函数
	var googlemap = function() {};

	// 属性和方法
	googlemap.prototype = {

		init: function () {

			var mapOptions = {
				center: new google.maps.LatLng(31.27120020000000, 120.73923440000002),
				zoom: 15,
				mapTypeId: google.maps.MapTypeId.SATELLITE
	        };

	        this.map = new google.maps.Map(document.getElementById("J_map"), mapOptions);
		},

		addMarker: function() {

			var geoJson = $.parseJSON('{{$data}}');
			var that = this;

			$.each(geoJson, function(index, value) {

				new google.maps.Marker({
					position: new google.maps.LatLng(value.lat, value.lng),
					map: that.map,
					title: "Map"
				});
			});
		}
	};

	// var baidumap = function() {};
	// baidumap.prototype = {

	// 	init: function() {

	// 		this.map = new BMap.Map('J_map');
	// 		this.map.centerAndZoom(this.getPoint(31.27120020000000, 120.73923440000002), 16	);
	// 	},

	// 	addMarker: function() {

	// 		var geoJson = $.parseJSON('{{$data}}');
	// 		var that = this;

	// 		$.each(geoJson, function(index, value) {
 
	// 			var marker = new BMap.Marker(that.getPoint(value.lat, value.lng));
	// 			that.map.addOverlay(marker);
	// 		});
	// 	},

	// 	getPoint: function(lat, lng) {

	// 		return new BMap.Point(lng, lat);
	// 	}
	// };

	$(document).ready(function() {

		var map = new googlemap;
		map.init();
		map.addMarker();
	});

</script>

{{/block}}